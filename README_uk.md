# üìä –ü–æ—Ä—Ç—Ñ–æ–ª—ñ–æ SQL: –ü—Ä–æ—î–∫—Ç–∏ –∞–Ω–∞–ª—ñ–∑—É –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö

–í—ñ—Ç–∞—é —É –º–æ—î–º—É –ø–æ—Ä—Ç—Ñ–æ–ª—ñ–æ SQL!  
–¶–µ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –º—ñ—Å—Ç–∏—Ç—å –ø—Ä–∏–∫–ª–∞–¥–∏ –ø—Ä–æ—î–∫—Ç—ñ–≤ —ñ–∑ –∞–Ω–∞–ª—ñ–∑—É –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö –∑ Facebook Ads —Ç–∞ Google Ads.  
–ö–æ–∂–µ–Ω –ø—Ä–æ—î–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î –ø—Ä–∞–∫—Ç–∏—á–Ω–µ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è SQL –¥–ª—è –±—ñ–∑–Ω–µ—Å-–∞–Ω–∞–ª—ñ–∑—É, –≤–∫–ª—é—á–∞—é—á–∏ –∞–≥—Ä–µ–≥–∞—Ü—ñ—é –¥–∞–Ω–∏—Ö, —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –∫–ª—é—á–æ–≤–∏—Ö –ø–æ–∫–∞–∑–Ω–∏–∫—ñ–≤ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ (KPI), –æ—Ü—ñ–Ω–∫—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –∫–∞–º–ø–∞–Ω—ñ–π —Ç–∞ –∞–Ω–∞–ª—ñ–∑ –¥–∏–Ω–∞–º—ñ–∫–∏ –ø–æ–∫–∞–∑–Ω–∏–∫—ñ–≤ —É —á–∞—Å—ñ.

---

## üóÑ –û–ø–∏—Å –¥–∞–Ω–∏—Ö

–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö –º—ñ—Å—Ç–∏—Ç—å –Ω–∞—Å—Ç—É–ø–Ω—ñ –æ—Å–Ω–æ–≤–Ω—ñ —Ç–∞–±–ª–∏—Ü—ñ:

- **facebook_ads_basic_daily**: –©–æ–¥–µ–Ω–Ω—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ —Ä–µ–∫–ª–∞–º–Ω–∏—Ö –∫–∞–º–ø–∞–Ω—ñ–π —É Facebook, –≤–∫–ª—é—á–∞—é—á–∏ –≤–∏—Ç—Ä–∞—Ç–∏, –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ–∫–∞–∑—ñ–≤, –∫–ª—ñ–∫—ñ–≤, –æ—Ö–æ–ø–ª–µ–Ω–Ω—è, –ª—ñ–¥—ñ–≤ —ñ –∑–∞–≥–∞–ª—å–Ω—É –≤–∞—Ä—Ç—ñ—Å—Ç—å –∫–æ–Ω–≤–µ—Ä—Å—ñ–π.
- **facebook_adset**: –î–µ—Ç–∞–ª—ñ —â–æ–¥–æ –Ω–∞–±–æ—Ä—ñ–≤ –æ–≥–æ–ª–æ—à–µ–Ω—å —É Facebook, –∑–æ–∫—Ä–µ–º–∞ –Ω–∞–∑–≤–∏ –Ω–∞–±–æ—Ä—ñ–≤ —ñ —ó—Ö–Ω—ñ–π –∑–≤'—è–∑–æ–∫ —ñ–∑ –∫–∞–º–ø–∞–Ω—ñ—è–º–∏.
- **facebook_campaign**: –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Ä–µ–∫–ª–∞–º–Ω—ñ –∫–∞–º–ø–∞–Ω—ñ—ó —É Facebook (–Ω–∞–∑–≤–∏ –∫–∞–º–ø–∞–Ω—ñ–π —Ç–∞ —ó—Ö —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∏).
- **google_ads_basic_daily**: –©–æ–¥–µ–Ω–Ω—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ —Ä–µ–∫–ª–∞–º–Ω–∏—Ö –∫–∞–º–ø–∞–Ω—ñ–π —É Google Ads, –∞–Ω–∞–ª–æ–≥—ñ—á–Ω—ñ –¥–æ –ø–æ–∫–∞–∑–Ω–∏–∫—ñ–≤ —É —Ç–∞–±–ª–∏—Ü—ñ `facebook_ads_basic_daily` (–≤–∏—Ç—Ä–∞—Ç–∏, –ø–æ–∫–∞–∑–∏, –∫–ª—ñ–∫–∏, –æ—Ö–æ–ø–ª–µ–Ω–Ω—è, –ª—ñ–¥–∏ —Ç–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å –∫–æ–Ω–≤–µ—Ä—Å—ñ–π).

–¶—ñ –¥–∞–Ω—ñ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å —â–æ–¥–µ–Ω–Ω—É —Ä–µ–∫–ª–∞–º–Ω—É –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö —Ü–∏—Ñ—Ä–æ–≤–∏—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö.  
–í–æ–Ω–∏ –º—ñ—Å—Ç—è—Ç—å —Ñ—ñ–Ω–∞–Ω—Å–æ–≤—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ (–≤–∏—Ç—Ä–∞—Ç–∏), –º–µ—Ç—Ä–∏–∫–∏ –≤–∑–∞—î–º–æ–¥—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ (–ø–æ–∫–∞–∑–∏, –∫–ª—ñ–∫–∏), –æ—Ö–æ–ø–ª–µ–Ω–Ω—è –∞—É–¥–∏—Ç–æ—Ä—ñ—ó, –∑–∞–ª—É—á–µ–Ω–Ω—è –ª—ñ–¥—ñ–≤ —ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∫–æ–Ω–≤–µ—Ä—Å—ñ–π.  
–¢–∞–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–∑–≤–æ–ª—è—î –ø—Ä–æ–≤–æ–¥–∏—Ç–∏ –¥–µ—Ç–∞–ª—å–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –∫–∞–º–ø–∞–Ω—ñ–π, —Ä–æ–∑—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤—ñ KPI —Ç–∞ –æ—Ü—ñ–Ω—é–≤–∞—Ç–∏ –¥–∏–Ω–∞–º—ñ–∫—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –¥–ª—è –ø—Ä–∏–π–Ω—è—Ç—Ç—è –æ–±“ë—Ä—É–Ω—Ç–æ–≤–∞–Ω–∏—Ö –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–∏—Ö —Ä—ñ—à–µ–Ω—å.

---

## üõ† –ü—Ä–æ—î–∫—Ç–∏

### 1. [facebook_google_ads_data_aggregation.sql](facebook_google_ads_data_aggregation.sql)

**–ú–µ—Ç–∞:**  
–û–±'—î–¥–Ω–∞—Ç–∏ —â–æ–¥–µ–Ω–Ω—ñ –¥–∞–Ω—ñ Facebook Ads —Ç–∞ Google Ads –≤ —î–¥–∏–Ω–∏–π –∫–æ–Ω—Å–æ–ª—ñ–¥–æ–≤–∞–Ω–∏–π –∑–≤—ñ—Ç.  
–í–∏–∫–æ–Ω–∞—Ç–∏ –∞–≥—Ä–µ–≥–∞—Ü—ñ—é –≤–∏—Ç—Ä–∞—Ç, –ø–æ–∫–∞–∑—ñ–≤, –∫–ª—ñ–∫—ñ–≤ —ñ –∑–Ω–∞—á–µ–Ω–Ω—è –∫–æ–Ω–≤–µ—Ä—Å—ñ–π –∑–∞ –¥–∞—Ç–æ—é –ø–æ–∫–∞–∑—É, –¥–∂–µ—Ä–µ–ª–æ–º —Ç—Ä–∞—Ñ—ñ–∫—É, –Ω–∞–∑–≤–æ—é –∫–∞–º–ø–∞–Ω—ñ—ó —Ç–∞ –Ω–∞–∑–≤–æ—é –Ω–∞–±–æ—Ä—É –æ–≥–æ–ª–æ—à–µ–Ω—å.

**–¢–µ—Ö–Ω—ñ–∫–∏:**

- –û–±'—î–¥–Ω–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `LEFT JOIN` —Ç–∞ `UNION ALL`.
- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —É–Ω—ñ—Ñ—ñ–∫–æ–≤–∞–Ω–æ–≥–æ –ø–æ–ª—è –¥–∂–µ—Ä–µ–ª–∞ —Ç—Ä–∞—Ñ—ñ–∫—É (media source).
- –ê–≥–≥—Ä–µ–≥–∞—Ü—ñ—è —Ä–µ–∫–ª–∞–º–Ω–∏—Ö –º–µ—Ç—Ä–∏–∫ –∑–∞ –∫—ñ–ª—å–∫–æ–º–∞ –≤–∏–º—ñ—Ä–∞–º–∏.

---

### 2. [top_campaign_romi_analysis.sql](top_campaign_romi_analysis.sql)

**–ú–µ—Ç–∞:**  
–í–∏–∑–Ω–∞—á–∏—Ç–∏ —Ä–µ–∫–ª–∞–º–Ω—É –∫–∞–º–ø–∞–Ω—ñ—é –∑ –Ω–∞–π–≤–∏—â–∏–º ROMI (Return on Marketing Investment) —Å–µ—Ä–µ–¥ –∫–∞–º–ø–∞–Ω—ñ–π —ñ–∑ –≤–∏—Ç—Ä–∞—Ç–∞–º–∏ –ø–æ–Ω–∞–¥ 500 000.  
–î–æ–¥–∞—Ç–∫–æ–≤–æ –∑–Ω–∞–π—Ç–∏ –Ω–∞–π–µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—à–∏–π –Ω–∞–±—ñ—Ä –æ–≥–æ–ª–æ—à–µ–Ω—å —É –º–µ–∂–∞—Ö —Ü—ñ—î—ó –∫–∞–º–ø–∞–Ω—ñ—ó –∑–∞ –ø–æ–∫–∞–∑–Ω–∏–∫–æ–º ROMI.

**–¢–µ—Ö–Ω—ñ–∫–∏:**

- –£–º–æ–≤–Ω–∞ –∞–≥—Ä–µ–≥–∞—Ü—ñ—è —Ç–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `GROUP BY` —Ç–∞ `HAVING`.
- –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ ROMI —á–µ—Ä–µ–∑ –±–∞–∑–æ–≤—É SQL-–∞–≥—Ä–µ–≥–∞—Ü—ñ—é.
- –°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –∞–≥—Ä–µ–≥–æ–≤–∞–Ω–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –Ω–∞–π–∫—Ä–∞—â–∏—Ö –ø–æ–∫–∞–∑–Ω–∏–∫—ñ–≤.

---

### 3. [utm_campaign_decoding_and_ads_metrics.sql](utm_campaign_decoding_and_ads_metrics.sql)

**–ú–µ—Ç–∞:**  
–í–∏–¥–æ–±—É—Ç–∏ —Ç–∞ –¥–µ–∫–æ–¥—É–≤–∞—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä `utm_campaign` —ñ–∑ —Ä–µ–∫–ª–∞–º–Ω–∏—Ö URL-–ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤.  
–†–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ –æ—Å–Ω–æ–≤–Ω—ñ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ñ KPI: CTR (Click-Through Rate), CPC (Cost Per Click), CPM (Cost Per Mille) —Ç–∞ ROMI.

**–¢–µ—Ö–Ω—ñ–∫–∏:**

- –í–∏–¥—ñ–ª–µ–Ω–Ω—è –ø–æ–ª—ñ–≤ UTM –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ä–µ–≥—É–ª—è—Ä–Ω–∏—Ö –≤–∏—Ä–∞–∑—ñ–≤ (`regexp`).
- –î–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è URL —á–µ—Ä–µ–∑ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—É SQL-—Ñ—É–Ω–∫—Ü—ñ—é.
- –û–±—Ä–æ–±–∫–∞ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Ö –∞–±–æ –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏—Ö –¥–∞–Ω–∏—Ö.
- –ë–µ–∑–ø–µ—á–Ω–µ –¥—ñ–ª–µ–Ω–Ω—è —É —Ñ–æ—Ä–º—É–ª–∞—Ö –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `CASE` –¥–ª—è —É–Ω–∏–∫–Ω–µ–Ω–Ω—è –ø–æ–º–∏–ª–æ–∫ –¥—ñ–ª–µ–Ω–Ω—è –Ω–∞ –Ω—É–ª—å.

---

### 4. [ads_metrics_monthly_trends_analysis.sql](ads_metrics_monthly_trends_analysis.sql)

**–ú–µ—Ç–∞:**  
–ê–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –¥–∏–Ω–∞–º—ñ–∫—É —Ä–µ–∫–ª–∞–º–Ω–∏—Ö –ø–æ–∫–∞–∑–Ω–∏–∫—ñ–≤ –∑–∞ –º—ñ—Å—è—Ü—è–º–∏ –ø–æ –∫–∞–º–ø–∞–Ω—ñ—è—Ö.  
–†–æ–∑—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ –º—ñ—Å—è—á–Ω—ñ –∑–º—ñ–Ω–∏ —É –≤—ñ–¥—Å–æ—Ç–∫–∞—Ö –¥–ª—è –∫–ª—é—á–æ–≤–∏—Ö KPI, —Ç–∞–∫–∏—Ö —è–∫ CPM, CTR —Ç–∞ ROMI.

**–¢–µ—Ö–Ω—ñ–∫–∏:**

- –ê–≥—Ä–µ–≥–∞—Ü—ñ—è –∑–∞ –º—ñ—Å—è—Ü—è–º–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `DATE_TRUNC`.
- –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤—ñ–∫–æ–Ω–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π (`LAG`) –¥–ª—è –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –∑–º—ñ–Ω –º—ñ–∂ –ø–µ—Ä—ñ–æ–¥–∞–º–∏.
- –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –≤—ñ–¥—Å–æ—Ç–∫–æ–≤–∏—Ö –∑–º—ñ–Ω –¥–ª—è –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É –¥–∏–Ω–∞–º—ñ–∫–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –∫–∞–º–ø–∞–Ω—ñ–π.

---

## ‚úçüèª –ü—ñ–¥—Å—É–º–æ–∫

–¶—ñ –ø—Ä–æ—î–∫—Ç–∏ –¥–µ–º–æ–Ω—Å—Ç—Ä—É—é—Ç—å –ø—Ä–∞–∫—Ç–∏—á–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥ –¥–æ –∞–Ω–∞–ª—ñ–∑—É —Ä–µ–∫–ª–∞–º–Ω–∏—Ö –∫–∞–º–ø–∞–Ω—ñ–π –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é SQL.  
–í–æ–Ω–∏ –æ—Ö–æ–ø–ª—é—é—Ç—å —Ç–µ—Ö–Ω—ñ–∫–∏ –∫–æ–Ω—Å–æ–ª—ñ–¥–∞—Ü—ñ—ó –±–∞–≥–∞—Ç–æ–ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö, —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –±—ñ–∑–Ω–µ—Å-–∫—Ä–∏—Ç–∏—á–Ω–∏—Ö KPI —Ç–∞ –æ—Ü—ñ–Ω–∫—É –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–∏—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π —É –¥–∏–Ω–∞–º—ñ—Ü—ñ.

–í—ñ–¥–∫—Ä–∏—Ç–∞ –¥–æ –ø—Ä–æ—Ñ–µ—Å—ñ–π–Ω–∏—Ö –æ–±–≥–æ–≤–æ—Ä–µ–Ω—å, –∑–≤–æ—Ä–æ—Ç–Ω–æ–≥–æ –∑–≤'—è–∑–∫—É —Ç–∞ —Å–ø—ñ–≤–ø—Ä–∞—Ü—ñ –≤ —Ç–µ–º–∞—Ö, –ø–æ–≤'—è–∑–∞–Ω–∏—Ö –∑ –∞–Ω–∞–ª—ñ–∑–æ–º –¥–∞–Ω–∏—Ö —ñ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–æ—é –∞–Ω–∞–ª—ñ—Ç–∏–∫–æ—é.

–©–∏—Ä–æ –¥—è–∫—É—é –∑–∞ —É–≤–∞–≥—É —Ç–∞ —ñ–Ω—Ç–µ—Ä–µ—Å –¥–æ –º–æ—î—ó —Ä–æ–±–æ—Ç–∏!
